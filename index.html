<!DOCTYPE html>
<!-- main home page -->
<html>
<head>
<script type="text/javascript" src="js/jquery.min.js"></script>
<link rel="stylesheet" href="css/jquery-ui.css">
<script type="text/javascript" src="js/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/jquery-1.12.4.js"></script>
<script type="text/javascript" src="js/jquery-ui.js"></script>
<script type="text/javascript" src="js/moment.min.js"></script>
<link rel="stylesheet" href="js/tabulator-master/dist/css/tabulator.min.css">
<script type="text/javascript" src="js/tabulator-master/dist/js/tabulator.min.js"></script>
<link href="css/chosen.min.css" rel="stylesheet">
<script type="text/javascript" src="js/chosen.jquery.min.js"></script>
<link rel="stylesheet" href="css/photoswipe.css">
<link rel="stylesheet" href="css/default-skin/default-skin.css">
<script src="js/photoswipe.min.js"></script>
<script src="js/photoswipe-ui-default.min.js"></script>
<link rel="stylesheet" href="css/default.css">

<title>SPT Data Quality</title>

</head>

<body>
  <script type="text/javascript" src="js/date_form.js"></script>
  <script>
    // handles switching between plotting modes. Need to rebuild the table
    // to change # of selectable obs and load new plot types.
    function swtch(val) {
      if (val == "timeseries") {
        $("#transfer_table").tabulator("destroy");
        make_t_table(true);
        $("#aux_table").tabulator("destroy");
        make_aux_table(true);
        document.getElementById("select").style = "display:inline";
      }
      else if (val == "individual") {
        $("#transfer_table").tabulator("destroy");
        make_t_table(10);
        $("#aux_table").tabulator("destroy");
        make_aux_table(10);
        document.getElementById("select").style = "display:none";
      }
      plot_list();
      // redraw since we are remaking the table
      redraw = true;
    }
  </script>

  <!-- Display blank page until content is loaded -->
  <div id='loader'></div>
  <div id='pagecontent' style='display:none'>
  <table>
    <tr>
      <th>Field</th>
      <th>Start</th>
      <th>End</th>
    </tr>
    <tr>
      <td>Date</td>
      <td><input type="text" id="date-from" name="date-from" onclick="date_chosen();"></td>
      <td><input type="text" id="date-to" name="date-to" onclick="date_chosen();"></td>
    </tr>
    <tr id="obsid-row">
      <td>Obs ID</td>
      <td><input type="number" id="obsid-from" name="obsid-from"></td>
      <td><input type="number" id="obsid-to" name="obsid-to"></td>
    </tr>
    <tr id="source-row">
      <td>Source</td>
      <td>
        <select type="text" id="obstype-search" class="chosen-select">
        <!-- WARNING: do not change value from "". If you do, the sql query
            breaks and will give a tabulator remote pagination error.
        -->
        <option value="">any</option>
        <!-- <option value="calibrator">calibrator</option> -->
        <!-- <option value="CenA">CenA</option> -->
        <!-- <option value="CenA-pixelraster">CenA-pixelraster</option> -->
        <!-- <option value="elnod">elnod</option> -->
        <!-- <option value="RCW38">RCW38</option> -->
        <!-- <option value="RCW38-pixelraster">RCW38-pixelraster</option> -->
        <!-- <option value="saturn">saturn</option> -->
        <!-- <option value="debug-forced-scanify">debug-forced-scanify</option> -->
        <!-- <option value="noise">noise</option> -->
        </select>
      </td>
      <td></td>
    </tr>
    <tr id="file-row">
      <td>Filename</td>
      <td><input type="text" id="file-search"></td>
      <td></td>
    </tr>
    <tr id="type-row">
      <td>Type</td>
      <td>
        <select type="text" id="auxtype-search" class="chosen-select">
        <option value="">any</option>
        <option value="arc">arc</option>
        <option value="eht">eht</option>
        <option value="pydfmux">pydfmux</option>
        <option value="pydfmuxlog">pydfmuxlog</option>
        <option value="rsync">rsync</option>
        <option value="tar">tar</option>
        </select>
      </td>
      <td></td>
    </tr>
    <tr>
      <td>Mode</td>
      <td>
        <div class="radio">
        <input type="radio" value="individual" name="func" id="rad_ind"
          onchange="swtch('individual');" checked>
        <label for="rad_ind" class="radio-label">Individual</label>
        </div>
        <div class="radio">
        <input type="radio" value="timeseries" name="func" id="rad_tim"
          onchange="swtch('timeseries');">
        <label for="rad_tim" class="radio-label">Timeseries</label>
        </div>
      </td>
      <td></td>
    </tr>
  </table>

  <br>

  <button class="btn" onclick="search()">Search</button>

  <button class="btn" onclick='$("#" + document.getElementsByClassName("tablinks active")[0].id + "_table").tabulator("selectRow");' style="display:none" id="select">Select All
  </button>
  <script>
    if ($('input[name="func"]:checked').val() == "timeseries")
      document.getElementById("select").style = "display:inline";
  </script>

  <button class="btn" onclick='$("#" + document.getElementsByClassName("tablinks active")[0].id + "_table").tabulator("deselectRow");' id="deselect">Deselect All
  </button>

  <button class="btn" onclick="window.open('https://pole.uchicago.edu/spt3g/index.php/SPT_Data_Quality', '_blank');">Help</button>

  <button class="btn" onclick="plot()">Plot</button>



  <br><br>

  <div id="plot-type">Plot type &nbsp</div>

  <br>

  <div class="tab">
    <button class="tablinks" onclick="open_tab(event, 'transfer_table')" id="transfer">Transfer</button>
    <button class="tablinks" onclick="open_tab(event, 'aux_table')" id="aux">Aux</button>
  </div>
  <div id="transfer_table" class="tabcontent"></div>
  <div id="aux_table" class="tabcontent"></div>
  </div>

  <script>
    // set initial date to be 1 month ago so the entire database doesn't load
    time = moment().subtract(4, "weeks");
    document.getElementById("date-from").value = time.format("YYYY-MM-DD");
  </script>

  <script type="text/javascript" src="js/plot_list.js"></script>
  <script type="text/javascript" src="js/table.js"></script>

  <script>
    // open default tab
    document.getElementById("transfer").click();
    // redraw aux tab on the first switch, otherwise it has no display when made
    redraw = true;
  </script>

  <script>
    // display page content
    $(document).ready(function() {
      $(window).load(function() {
        $('#loader').hide();
        $('#pagecontent').show();
        // plot list needs to be made after diplay is active
        make_plot_list();
        // redraw tabulator header after display is active
        $("#transfer_table").tabulator("redraw", true);
        // create entries for the source list dropdown menu
        make_source_list();
      });
    });
  </script>

</body>
</html>
